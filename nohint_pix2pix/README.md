# Colorization with pix2pix
## Summary

![](https://github.com/SerialLain3170/Line-to-Color/blob/master/nohint_pix2pix/data/network.png)

- This directory implements colorization without hint based on [pix2pix](https://arxiv.org/pdf/1611.07004.pdf) + zero-centered gradient penalty
- This also implements colorization with atari

## Usage

### Traning Phase
#### Command
Execute the command line below.

```bash
$ python train.py --data_path <DATA_PATH> --sketch_path <SKETCH_PATH>
```
- `DATA_PATH`: The name of the directory that contains color images
- `SKETCH_PATH`: The name of the direcotyr that contains line arts obtained by SketchKeras

File names of `DATA_PATH` must correspond to those of `SKETCH_PATH`. The examples of dataset structures are as follows.

```
ex1

DATA_PATH - file1.jpg
          - file2.jpg
          ...

SKETCH_PATH - file1.jpg
            - file2.jpg
            ...
```

```
ex2

DATA_PATH - dir1 - file1.jpg
                 - file2.jpg
          - dir2 - file3.jpg
                 - file4.jpg
          ...
          
SKETCH_PATH - file1.jpg
            - file2.jpg
            - file3.jpg
            - file4.jpg
            ...
```

#### Training Options
You have some options in training by rewriting `param.yaml`.

- Presence of hint
  - If you intend to train the model without hint, you should set `train.mask` in `param.yaml` to `false`
- Presece of gradient penalty
  - If you intend to train the model without gradient penalty, you should et `loss.gp` in `param.yaml` to `0.0`
- Another type of gradient penalty
  - If you intend to train the model with one-centered gradient penalty, you should et `loss.center` in `param.yaml` to `one`

## Result
Result generated by my development environment is below.

- pix2pix & pix2pix-gp nohint

![](../Data/nohint_comparison.png)

- pix2pix atari
![](https://github.com/SerialLain3170/Line-to-Color/blob/master/nohint_pix2pix/data/atari_result1.png)
![](https://github.com/SerialLain3170/Line-to-Color/blob/master/nohint_pix2pix/data/atarI_result2.png)

- pix2pix zero-centered gradient penalty atari
![](https://github.com/SerialLain3170/Line-to-Color/blob/master/nohint_pix2pix/data/atari_gp_result1.png)
![](https://github.com/SerialLain3170/Line-to-Color/blob/master/nohint_pix2pix/data/atari_gp_result2.png)

- Batch size: 16
- Using Adam as optimizer(lr=0.0002, beta1=0.5, beta2=0.99)
